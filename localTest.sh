#!/bin/bash
echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"
echo "+++++++++++++++++++++COMPILING+++++++++++++++++++++++++++++"
echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"
mvn package
cd target
rm abcd

echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"
echo "++++++++++++++++++STARTING SERVER++++++++++++++++++++++++++"
echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"
java -cp P2MP-FTP-0.1-jar-with-dependencies.jar main/P2mpserver 7735 abcd 0.01 & PID_S=$!

echo ""
echo ""
echo ""
echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"
echo "++++++++++++++++++STARTING CLIENT++++++++++++++++++++++++++"
echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"
echo ""
echo ""
echo ""
java -cp P2MP-FTP-0.1-jar-with-dependencies.jar main/P2mpclient 127.0.0.1 7735 abc.txt 100 & PID_C=$!

wait $PID_S
wait $PID_C

echo ""
echo ""
echo ""
echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"
echo "++++++++++++++++++++++++++DIFF+++++++++++++++++++++++++++++"
echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"
echo ""
echo ""

diff abc.txt abcd

echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"
echo "+++++++++++++++++++TEST FINISHED+++++++++++++++++++++++++++"
echo "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++"